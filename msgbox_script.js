function loadmsg(a,b,c){el('msg').innerHTML="<p style='font-size:1.7em;position:absolute;top:150px;left:600px;'>"+loading+"</p>";wmsg.postMessage("loadmsg list="+a+"&msgid="+b+"&id="+c);wmsg.onmessage=function(e){el('msg').innerHTML=e.data;attach_hovercard();}}function sender_receiverlist(a){el("msg").innerHTML="";el("readinlist").innerHTML="<p style='font-size:1.4em;'></br></br></br>"+loading+"</p>";el(a).style.background="grey";el("img"+a).setAttribute("src","down.png");if(a!="sent"){el("sent").style.background="pink";el("imgsent").setAttribute("src","up.png")}if(a!="read"){el("read").style.background="pink";el("imgread").setAttribute("src","up.png")}if(a!="unread"){el("unread").style.background="pink";el("imgunread").setAttribute("src","up.png")}wmsg.postMessage("sender_receiver list="+a);wmsg.onmessage=function(e){el('readinlist').innerHTML=e.data}}function reply(){show("msgmenu");$("#msgmenu").hide();$("#msgmenu").show("slow")}function sendmsg(){$("#msgmenu").hide("slow");var a=document.forms.msgform,text=encodeURIComponent(a.elements.msg.value),title=encodeURIComponent(a.elements.title.value),toid=a.elements.fromid.value;if(text){el('body').style.opacity=".2";el('uploading').innerHTML="Sending your message.............";show('uploading');var b="msg="+text+"&title="+title+"&toid="+toid;wmsg.postMessage("sendmsg "+b);wmsg.onmessage=function(e){if(e.data=="success"){hide('uploading');el("success").innerHTML='Msg successfully sent&nbsp;&nbsp;<spam id="okbutton" onclick="hidemsg()"><a href="#">OK</a></spam>';show("success")}else{hide('uploading');el("success").innerHTML='Your msg could not be sent&nbsp;&nbsp;<spam id="okbutton" onclick="hidemsg()"><a href="javascript:void(0)">OK</a></spam>';el("success").style.color="Red";show("success")}}}else{$("#msgmenu").show("slow");alert("Please write something in text area")}}function hidemsg(){hide("success");el("body").style.opacity="1"}function offmsg(){$("#msgmenu").hide("slow")}function delmsg(a,b,c){el("body").style.opacity=".2";el('uploading').innerHTML="Deleting the message............";show('uploading');var d=null,deleted=false,color="red";if(a=="in"){if(responsetext("msgid="+b,"delmsg1.php")=="success"){d="Msg successfully deleted";deleted=true;color="green"}else d="Failed to delete msg"}else if(a=="sent"){if(responsetext("msgid="+b,"delsentmsg1.php")=="success"){d="Msg successfully deleted";deleted=true;color="green"}else d="Failed to delete msg"}hide('uploading');el("success").style.color=color;el("success").innerHTML=d+'&nbsp;&nbsp;<spam id="okbutton" onclick="hidemsg()"><a href="javascript:void(0)">OK</a></spam>';show("success");if(deleted){el('msg').innerHTML="";el(b).innerHTML="";hide(b);if(parseInt(inner("msgsfromuser"+c))>0)el("msgsfromuser"+c).innerHTML=--el("msgsfromuser"+c).innerHTML}}function displayuserinfo(a){el('body').style.opacity=".2";show("userinfo");el("userinfo").innerHTML="<p style='font-size:1.4em;width:400px;height:100px;'>Loading.................";wmsg.postMessage("userinfo id="+a);wmsg.onmessage=function(e){el("userinfo").innerHTML=e.data}}function hideinfo(){hide("userinfo");el("body").style.opacity="1"}function load_msglist(a,b){el("msg").innerHTML="";el('div'+a).setAttribute("href","javascript:hide_msglist('"+a+"','"+b+"')");el('div'+a).setAttribute("title","Hide message list");el('div'+a).firstChild.style.background="grey";el('li'+a).style.border="3px solid black";el('user'+a).style.border="4px solid white";el('user'+a).innerHTML=loading;show('user'+a);if(parseInt(inner("msgsfromuser"+a))>0){wmsg.postMessage("msglist id="+a+"&type="+b);wmsg.onmessage=function(e){el('user'+a).innerHTML=e.data}}else{el('user'+a).innerHTML="<li>No more messages</li>"}}function hide_msglist(a,b){el("msg").innerHTML=" ";el('div'+a).setAttribute("href","javascript:load_msglist('"+a+"','"+b+"')");el('div'+a).setAttribute("title","click to show messages sent by this user");el('div'+a).firstChild.style.background="pink";el('li'+a).style.border="1px dotted black";el('user'+a).innerHTML="";el('user'+a).style.border="none";hide('user'+a)}var loading='<img src="picon1.gif"> Loading..........';var wmsg=new Worker("w_msgbox.js");