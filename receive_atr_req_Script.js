preload(["checkmark.gif","noti.gif"]);sessionStorage.setItem('atr_count','1');var atr_count=sessionStorage.getItem('atr_count');function get_atr_req(){el('req').innerHTML="<p style='font-size:1.4em;width:500px;height:200px;'></br></br></br>"+loading+"</p>";el('atr_rqst').setAttribute("onclick","");el('body').style.opacity=".2";show('req');$("#req").show();if(parseInt(atr_count)>parseInt(inner('total_atr_req')))atr_count=inner('total_atr_req');w.postMessage("receive_atr_req n="+atr_count);w.onmessage=function(e){el('req').innerHTML=e.data;if(parseInt(inner('total_atr_req'))>1){var a=el("atr_table");var b=a.insertRow((parseInt(getRowIndex("atr_table","atr_tr2"))+1));b.setAttribute("id","atr_tr3");var c=b.insertCell(0);c.setAttribute("align","left");c.setAttribute("colspan","2");c.innerHTML="<img src='redb1.png' height='20' width='30' style='cursor:pointer;' id='atr_prev' class='hidden' title='Previous authority request' onclick='prev_atr_req();'>&nbsp;<img src='redf1.png' height='20' width='30' id='atr_next' style='cursor:pointer;' class='hidden' title='Next authority request' onclick='get_atr_req();'> "}else{if(el('atr_tr3')){el("atr_table").deleteRow(getRowIndex("atr_table","atr_tr3"))}}if(parseInt(atr_count)<=1)hide('atr_prev');else show('atr_prev');if(parseInt(atr_count)>=parseInt(inner('total_atr_req')))hide('atr_next');else show('atr_next');atr_count++}}function prev_atr_req(){el('req').innerHTML="<p style='font-size:1.4em;width:500px;height:200px;'></br></br></br>"+loading+"</p>";var d=parseInt(atr_count)-2;atr_count=d+1;w.postMessage("receive_atr_req n="+d);w.onmessage=function(e){el('req').innerHTML=e.data;if(parseInt(inner('total_atr_req'))>1){var a=el("atr_table");var b=a.insertRow((parseInt(getRowIndex("atr_table","atr_tr2"))+1));b.setAttribute("id","atr_tr3");var c=b.insertCell(0);c.setAttribute("align","left");c.setAttribute("colspan","2");c.innerHTML="<img src='redb1.png' height='20' width='30' style='cursor:pointer;' id='atr_prev' class='hidden' title='Previous authority request' onclick='prev_atr_req();'>&nbsp;<img src='redf1.png' height='20' width='30' id='atr_next' style='cursor:pointer;' class='hidden' title='Next authority request' onclick='get_atr_req();'> "}else{if(el('atr_tr3')){el("atr_table").deleteRow(getRowIndex("atr_table","atr_tr3"))}}if(d<=1)hide('atr_prev');else show('atr_prev');if((parseInt(atr_count)-1)>=parseInt(inner('total_atr_req')))hide('atr_next');else show('atr_next')}}function handle_atrReq(a,b){el('atr_btnset').innerHTML="<img src='picon1.gif'>&nbspPlease wait........";w.postMessage("art_action id="+a+"&update=true&action="+b);w.onmessage=function(e){if(parseInt(e.data)==1){if(b=='allow'){var r='granted'}else{var r='request rejected'}el('atr_btnset').innerHTML="<span style='text-shadow:4px 4px 4px black;'><img src='checkmark.gif' height='20' width='25' align='middle'>Authority "+r+"</span>";el('total_atr_req').innerHTML=--el('total_atr_req').innerHTML}else{if(b=='allow')var r="Failed to grant authority";else r='Failed to reject request';el('atr_btnset').innerHTML="<span style='color:red;'>Error: "+r+"</span>"}}}function hide_atr(){$("#req").hide("slow",function(){el('body').style.opacity='1';if(parseInt(inner('total_atr_req'))<=0)el('atr_rqst').setAttribute("onclick","");else el('atr_rqst').setAttribute("onclick","get_atr_req();")})}get_atr_req();